# GroupUp 云服务购买指南

## 📋 需要购买的服务清单

### 1. 主机服务器（必需）
**推荐方案：阿里云 ECS**
- **配置**: 4核8G (企业客户199元/年方案很划算)
- **系统**: Ubuntu 22.04
- **硬盘**: 80GB ESSD
- **带宽**: 5M固定带宽
- **价格**: 约199-299元/月

### 2. 数据库服务（可选）
**方案A：使用ECS自建** (推荐初期)
- PostgreSQL安装在ECS上
- 成本: 0元（已包含在ECS中）

**方案B：云数据库RDS** (用户量大时)
- RDS PostgreSQL版
- 2核4GB，100GB存储
- 价格: 约227元/月

### 3. 对象存储OSS（必需）
- **用途**: 存储用户照片
- **容量**: 500GB
- **流量**: 按使用付费
- **价格**: 约118元/月

### 4. CDN加速（推荐）
- **用途**: 加速图片访问
- **流量包**: 100GB/月
- **价格**: 约20-50元/月

### 5. 域名（必需）
- **.com域名**: 约60元/年
- **SSL证书**: 免费(Let's Encrypt)

### 6. 备案（国内必需）
- **ICP备案**: 免费但需要时间
- **时间**: 7-20个工作日

## 💰 成本预算

### 初期方案（1000-2000用户）
| 服务 | 配置 | 月费用 |
|------|------|--------|
| ECS服务器 | 4核8G | ¥199 |
| OSS存储 | 500GB | ¥118 |
| CDN | 100GB | ¥30 |
| 域名 | .com | ¥5 |
| **总计** | | **¥352/月** |

### 优化方案（省钱技巧）
1. **新用户优惠**: 首年可享受1-3折
2. **包年优惠**: 一次购买1年省15%
3. **企业认证**: 享受企业特惠价格
4. **OSS按量付费**: 初期用户少，实际费用更低

## 🏗️ 后端架构安排

### 第一阶段：单机部署（0-2000用户）
```
┌─────────────────────────────┐
│      阿里云 ECS 4核8G       │
├─────────────────────────────┤
│  ┌─────────┐ ┌───────────┐ │
│  │  Nginx  │ │  Docker   │ │
│  └─────────┘ └───────────┘ │
│  ┌─────────────────────────┐│
│  │   Docker Compose 服务   ││
│  │  - PostgreSQL          ││
│  │  - Supabase API        ││
│  │  - Auth Service        ││
│  │  - Storage Service     ││
│  └─────────────────────────┘│
└─────────────────────────────┘
         ↓              ↓
    ┌────────┐    ┌─────────┐
    │  OSS   │    │   CDN   │
    └────────┘    └─────────┘
```

### 第二阶段：分离部署（2000-5000用户）
```
┌──────────────┐  ┌──────────────┐
│  ECS-Web     │  │  RDS-PG      │
│  2核4G       │  │  4核8G       │
└──────────────┘  └──────────────┘
       ↓                ↓
┌──────────────┐  ┌──────────────┐
│  OSS+CDN     │  │  Redis       │
└──────────────┘  └──────────────┘
```

### 第三阶段：集群部署（5000+用户）
```
     ┌─────────┐
     │   SLB   │
     └────┬────┘
    ┌─────┴─────┐
    ↓           ↓
┌────────┐  ┌────────┐
│ ECS-1  │  │ ECS-2  │
└────────┘  └────────┘
    ↓           ↓
┌────────────────────┐
│   RDS主从集群      │
└────────────────────┘
```

## 🚀 部署步骤

### 1. 购买服务
```bash
# 购买顺序
1. 域名 → 2. ECS → 3. OSS → 4. 备案
```

### 2. 初始化ECS
```bash
# SSH登录
ssh root@your-ecs-ip

# 安装Docker
curl -fsSL https://get.docker.com | bash

# 克隆项目
git clone https://github.com/your-repo/groupup.git
cd groupup
```

### 3. 配置OSS
```javascript
// 在代码中配置OSS
const OSS = require('ali-oss');
const client = new OSS({
  region: 'oss-cn-hangzhou',
  accessKeyId: 'your-access-key',
  accessKeySecret: 'your-secret',
  bucket: 'groupup-photos'
});
```

### 4. 启动服务
```bash
# 使用生产环境配置
docker-compose -f docker-compose.production.yml up -d
```

## 📝 注意事项

1. **备案要求**
   - 必须先备案才能使用国内服务器
   - 个人备案不能用于商业用途
   - 企业备案流程约2-3周

2. **安全配置**
   - 配置安全组只开放80/443端口
   - 使用密钥对登录，禁用密码
   - 定期备份数据

3. **性能优化**
   - 使用OSS存储图片，不占用服务器空间
   - 启用CDN加速静态资源
   - 配置Nginx缓存

4. **成本控制**
   - OSS和CDN按量付费，避免浪费
   - 定期清理无用数据
   - 监控流量使用情况

## 🎯 推荐购买链接

1. [阿里云新用户优惠](https://www.aliyun.com/minisite/goods)
2. [ECS限时优惠](https://ecs-buy.aliyun.com)
3. [OSS产品页](https://www.aliyun.com/product/oss)

---
💡 建议：先购买最小配置测试，根据实际使用情况再升级。